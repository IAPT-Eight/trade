{{extend 'layout.html'}}

{{from collections import namedtuple}}

{{display_name = 'Your' if is_users_page else user.username+"'s"}}
{{ListFilter = namedtuple('ListFilter', ['list_name', 'href', 'active', 'count', 'icon'])}}
{{
  list_filters = [
    ListFilter('All', URL(args=request.args, host=True), current_filter == None, sum(list_sizes.values()), None),
    ListFilter("%s Public" % display_name, URL(args=request.args, vars={'filter': LIST_PUBLIC_COLLECTION}, host=True), current_filter == LIST_PUBLIC_COLLECTION, list_sizes[LIST_PUBLIC_COLLECTION], None),
    ListFilter("%s Has" % display_name, URL(args=request.args, vars={'filter': LIST_TRADING}, host=True), current_filter == LIST_TRADING, list_sizes[LIST_TRADING], None),
    ListFilter("%s Wants" % display_name, URL(args=request.args, vars={'filter': LIST_WISH_LIST}, host=True), current_filter == LIST_WISH_LIST, list_sizes[LIST_WISH_LIST], None),
  ]

  if is_users_page:
    list_filters.append(
      ListFilter("%s Private" % display_name, URL(args=request.args, vars={'filter': LIST_PRIVATE_COLLECTION}, host=True), current_filter == LIST_PRIVATE_COLLECTION, list_sizes[LIST_PRIVATE_COLLECTION], 'fa fa-fw fa-lock')
    )
    pass
}}

<div class="row">
    <div class="col-md-3 well well-sm">
        <h4><i class="fa fa-fw fa-search"></i> Filter</h4>
        <ul class="nav nav-pills nav-stacked">
            {{for filter in list_filters:}}
                <li role="presentation"
                    {{if filter.active:}}
                      class="active"
                    {{pass}}
                >
                    <a href={{=filter.href}}>
                        {{if filter.icon:}}
                            <i class="{{=filter.icon}}"></i>
                        {{pass}}

                        {{=filter.list_name}}
                        <span class="badge pull-right">
                            {{=filter.count}}
                        </span>
                    </a>
                </li>
            {{pass}}
        </ul>

    </div>
    <div class="col-md-9">

        {{if is_users_page:}}
            <a href="{{=URL(c='items', f='add_item')}}"
                class="btn btn-primary pull-right">
                <i class="fa fa-fw fa-plus-circle"></i>
                Add a new item
            </a>

        {{else:}}
            <a href="{{=URL(c='trade', f='new', args=[user.id])}}"
                class="btn btn-primary pull-right">
                <i class="fa fa-exchange"></i>
                Propose a trade
            </a>

        {{pass}}

        <h2>
            <i class="fa fa-fw fa-user"></i>
            {{=user.first_name}} {{=user.last_name}}
            <span class="text-muted">({{=user.username}})</span>

        </h2>

        <hr />


        {{if is_users_page and len(items) == 0:}}
            <div class="alert alert-block alert-info">
                <h4>
                    <i class="fa fa-fw fa-info-circle"></i>
                    New here?
                </h4>
                <p>
                    Start adding items you want to trade or share with the world to your collection, clicking on the "Add new Item" button.
                </p>

                <p>
                    Otherwise, click on "Explore" to browse other users' collections.
                </p>

            </div>

        {{else:}}
            <div id="users_items">

                {{include 'items/preview-list.html'}}

            </div>
        {{pass}}


    </div>
</div>
